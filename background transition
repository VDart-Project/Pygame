import random
import pygame
import os
pygame.init()

screen = pygame.display.set_mode((800, 600))
pygame.display.set_caption("V-Dodge")
icon = pygame.image.load('spaceship.png')
pygame.display.set_icon(icon)
bg = pygame.image.load(os.path.join('pygame_background.png')).convert()
bgX = 0
bgX2 = bg.get_width()

clock = pygame.time.Clock()

playerImg = pygame.image.load('vdart_logo.png')
playerX = 80
playerY = 220
vel = 10

asteroidImg = []
asteroidX = []
asteroidY = []
asteroidX_change = []
asteroidY_change = []
num_asteroid = 5

for i in range(num_asteroid):
    asteroidImg.append(pygame.image.load('asteroid.png'))
    asteroidX.append(random.randint(650, 750))
    asteroidY.append(random.randint(50, 450))
    asteroidX_change.append(i)
    asteroidY_change.append(i)

# Score
score_value = 0
font = pygame.font.Font('freesansbold.ttf', 32)

textX = 10
testY = 10

# Game Over
over_font = pygame.font.Font('freesansbold.ttf', 64)

def game_over_text():
    over_text = over_font.render("GAME OVER", True, (255, 255, 255))
    screen.blit(over_text, (200, 250))

def player(x, y):
    screen.blit(playerImg, (x, y))

def asteroid(x: object, y: object) -> object:
    screen.blit(asteroidImg[i], (x, y))

def redrawWindow():
    screen.blit(bg, (bgX, 0))
    screen.blit(bg, (bgX2, 0))
    player(playerX, playerY)
    asteroid(asteroidX[i], asteroidY[i])
    pygame.display.update()

speed = 25
running_game = True
while running_game:
    redrawWindow()
    clock.tick(speed)
    bgX -= 1.4  # Move both background images back
    bgX2 -= 1.4

    if bgX < bg.get_width() * -1:  # If our bg is at the -width then reset its position
        bgX = bg.get_width()

    if bgX2 < bg.get_width() * -1:
        bgX2 = bg.get_width()

    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running_game = False
            pygame.quit()
            quit()
    clock.tick(speed)

    keys = pygame.key.get_pressed()
    if keys[pygame.K_UP]:
        playerY -= vel
    if keys[pygame.K_DOWN]:
        playerY += vel

    screen.fill((0, 0, 0))
    screen.blit(bg, (0, 0))

    if playerY <= 0:
        playerY = 0
    elif playerY >= 566:
        playerY = 566

    # Movement of Asteroids
    for i in range(num_asteroid):
        asteroidX[i] += asteroidX_change[i]
        asteroidY[i] = asteroidY_change[i]
        if asteroidX[i] > 0:
            asteroidX_change[i] = -20
        elif asteroidX[i] <= 0:
            rnd_x = random.randrange(650, 750)
            rnd_y = random.randrange(40, 400)
            asteroidX_change[i] = rnd_x
            asteroidY_change[i] = rnd_y
        if playerX == asteroidX_change[i] and playerY == asteroidY_change[i]:
            game_over_text()

    asteroid(asteroidX[i], asteroidY[i])
    player(playerX, playerY)
    pygame.display.update()
